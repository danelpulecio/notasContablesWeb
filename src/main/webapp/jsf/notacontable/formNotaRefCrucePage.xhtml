<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:f="http://java.sun.com/jsf/core"
				xmlns:p="http://primefaces.org/ui"
				template="../../common/template.xhtml">
	
	<h:panelGrid columns="1" width="100%" cellpadding="0" cellspacing="0" >
		<p:accordionPanel opened="true" style="width: 100%" label="Cuentas" switchType="client" >
			<h:panelGrid width="100%" cellpadding="0" cellspacing="0" style="border-width: 0px; background-color: transparent;" id="cuentas">
				<p:dataGrid value="#{notaRefCrucePage.cuentas}"  var="cuenta" columns="8" width="100%" cellpadding="0" cellspacing="0" >
					<h:panelGrid columns="2">
						<h:selectBooleanCheckbox value="#{cuenta.seleccionada}" immediate="true"/>
						<h:outputText value="#{cuenta.cuenta}" />
					</h:panelGrid>
				</p:dataGrid>
			</h:panelGrid>
			<h:commandButton action="#{notaRefCrucePage.seleccionar}" value="Seleccionar/Deseleccionar" reRender="cuentas"/>
			<h:inputText  styleClass="bold" value="#{notaRefCrucePage.param}" immediate="true"/>
			<h:commandButton action="#{notaRefCrucePage.buscarFiltro}" value="Buscar" reRender="partPendientes"/>
			
		</p:accordionPanel>
		<h:panelGroup id="partPendientes">
			<p:panel header="Partidas Pendientes Disponibles" style="width: 100%;" rendered="#{! empty notaRefCrucePage.partidasPendientes}">
				<p:dataTable value="#{notaRefCrucePage.partidasPendientes}" var="partida" id="tablePartDisp" rowKeyVar="rowKey" width="100%" rows="5"
				footerClass="row2" onRowMouseOver="this.style.backgroundColor='#9fbdeb'" onRowMouseOut="this.style.backgroundColor='#{a4jSkin.rowBackgroundColor}'" rowClasses="row1, row2">
					<f:facet name="header">
						<p:dataScroller fastControls="false" pageIndexVar="pageIndex" pagesVar="pages" style="color:black;" for="tablePartDisp" maxPages="10" renderIfSinglePage="false"
						page="#{notaRefCrucePage.scrollPage}" limitToList="true" reRender="partPendientes" fastStep="3">
						</p:dataScroller>
					</f:facet>
	
					<p:column sortable="true" sortBy="#{partida.cuenta}">
	                    <f:facet name="header"><h:outputText value="Cuenta" /></f:facet>
	                    <h:outputText value="#{partida.cuenta}" />
	                </p:column>
					
					<p:column sortable="true" sortBy="#{partida.sucursalDestino}">
	                    <f:facet name="header"><h:outputText value="Suc Destino" /></f:facet>
	                    <h:outputText value="#{partida.sucursalDestino}" />
	                </p:column>
					
					<p:column sortable="true" sortBy="#{partida.naturaleza}">
	                    <f:facet name="header"><h:outputText value="Nat" /></f:facet>
	                    <h:outputText value="#{partida.naturaleza}" />
	                </p:column>
					
					<p:column sortable="true" sortBy="#{partida.divisa}">
	                    <f:facet name="header"><h:outputText value="Div" /></f:facet>
	                    <h:outputText value="#{partida.divisa}" />
	                </p:column>
					
					<p:column sortable="true" sortBy="#{partida.referenciaCruce}">
	                    <f:facet name="header"><h:outputText value="Ref Cruce" /></f:facet>
	                    <h:outputText value="#{partida.referenciaCruce}" />
	                </p:column>
					
					<p:column style="text-align: right;" sortable="true" sortBy="#{partida.importe}">
	                    <f:facet name="header" ><h:outputText value="Importe" /></f:facet>
	                    <h:outputText value="#{partida.importe}" ><f:convertNumber type="currency" /></h:outputText>
	                </p:column>
					
					<p:column sortable="true" sortBy="#{partida.concepto}">
	                    <f:facet name="header"><h:outputText value="Concepto" /></f:facet>
	                    <h:outputText value="#{partida.concepto}" />
	                </p:column>
					
					<p:column sortable="true" sortBy="#{partida.fechaContable}">
	                    <f:facet name="header"><h:outputText value="Fecha Contable" /></f:facet>
	                    <h:outputText value="#{partida.fechaContable}" />
	                </p:column>
					
					<p:column style="text-align: center;">
	                    <f:facet name="header"><h:outputText value="Agregar" /></f:facet>
	                    <h:commandButton action="#{notaRefCrucePage.adicionar}" reRender="partPendientes,partSeleccionadas,opcionesNotaRefCruce" value="+">
		                    <f:param name="selPart" value="true" assignTo="#{partida.seleccionada}" converter="javax.faces.Boolean" />
	                    </h:commandButton>
	                </p:column>
					<!--	Se muestra la informaciÃ³n de la cantidad de registros y la pagina actual	-->
					<f:facet name="footer">
						<p:dataScroller style="color:black;" align="center" for="tablePartDisp" page="#{notaRefCrucePage.scrollPage}" boundaryControls="hide" fastControls="hide" stepControls="hide">
							<f:facet name="pages">
								<h:outputText value="Visualizando del #{((pageIndex-1)*5)+1 } al #{(pages!=pageIndex)?(pageIndex*5):notaRefCrucePage.totalFilas} de un total de #{notaRefCrucePage.totalFilas} registros." />
							</f:facet>
						</p:dataScroller>
					</f:facet>
				</p:dataTable>
			</p:panel>
		</h:panelGroup>
		<h:panelGroup id="partSeleccionadas">
			<p:panel header="Partidas Pendientes Seleccionadas" style="width: 100%;" rendered="#{! empty notaRefCrucePage.partidasSeleccionadas}">
				<p:dataTable value="#{notaRefCrucePage.partidasSeleccionadas}" var="partida" id="tablePartSel" rowKeyVar="rowKey" width="100%"
				footerClass="row2" onRowMouseOver="this.style.backgroundColor='#9fbdeb'" onRowMouseOut="this.style.backgroundColor='#{a4jSkin.rowBackgroundColor}'" rowClasses="row1, row2">
					
					<p:column>
	                    <f:facet name="header"><h:outputText value="Cuenta" /></f:facet>
	                    <h:outputText value="#{partida.cuenta} " />
	                </p:column>
					
					<p:column>
	                    <f:facet name="header"><h:outputText value="Suc Destino" /></f:facet>
	                    <h:outputText value="#{partida.sucursalDestino} " />
	                </p:column>
					
					<p:column>
	                    <f:facet name="header"><h:outputText value="Nat" /></f:facet>
	                    <h:outputText value="#{partida.naturaleza} " />
	                </p:column>
					
					<p:column>
	                    <f:facet name="header"><h:outputText value="Ref Cruce" /></f:facet>
	                    <h:outputText value="#{partida.referenciaCruce}" />
	                </p:column>
					
					<p:column>
	                    <f:facet name="header"><h:outputText value="Concepto" /></f:facet>
	                    <h:outputText value="#{partida.concepto}" />
	                </p:column>
					
					<p:column>
	                    <f:facet name="header"><h:outputText value="Fecha Contable" /></f:facet>
	                    <h:outputText value="#{partida.fechaContable}" />
	                </p:column>
					
					<p:column>
	                    <f:facet name="header"><h:outputText value="Div" /></f:facet>
	                    <h:outputText value="#{partida.divisa}" />
	                </p:column>
					
					<p:column style="text-align: right;">
	                    <f:facet name="header" ><h:outputText value="Importe" /></f:facet>
	                    <h:outputText value="#{partida.importe}" ><f:convertNumber type="currency" /></h:outputText>
	                </p:column>
	                
					<p:column style="text-align: center;">
	                    <f:facet name="header"><h:outputText value="Quitar" /></f:facet>
	                    <h:commandButton action="#{notaRefCrucePage.remover}" reRender="partPendientes,partSeleccionadas,opcionesNotaRefCruce" value="-">
		                    <f:param name="selPart1" value="true" assignTo="#{partida.seleccionada}" converter="javax.faces.Boolean" />
	                    </h:commandButton>
	                </p:column>
	                <f:facet name="footer" >
						<p:columnGroup rendered="#{! empty notaRefCrucePage.totalesNota}">
							<p:column colspan="6" style="text-align:right;"><h:outputText value="Totales" /></p:column>
							<p:column style="padding: 0px;">
								<p:dataTable style="border-width: 0px; background-color: transparent;" value="#{notaRefCrucePage.totalesNota}" var="total" >
									<p:column style="border-width: 0px;"><h:outputText value="#{total.codigoDivisa }" /></p:column>
								</p:dataTable>
							</p:column>
							<p:column style="padding: 0px;">
								<p:dataTable style="border-width: 0px; background-color: transparent;" value="#{notaRefCrucePage.totalesNota}" var="total" >
									<p:column  style="border-width: 0px; text-align:right;"><h:outputText value="#{total.total}" ><f:convertNumber type="currency" /></h:outputText></p:column>
								</p:dataTable>
							</p:column>
							<p:column ></p:column>
						</p:columnGroup>
					</f:facet>
					
				</p:dataTable>
			</p:panel>
		</h:panelGroup>
		<h:panelGrid columns="2" styleClass="center" width="100%" id="opcionesNotaRefCruce">
			<h:commandButton action="#{notaRefCrucePage.guardar}" value="Enviar a Visto Bueno" reRender="partPendientes,partSeleccionadas,opcionesNotaRefCruce" rendered="#{! empty notaRefCrucePage.partidasSeleccionadas}"/>
			<h:commandButton value="Cancelar" action="#{notaRefCrucePage.cancelar}" reRender="partPendientes,partSeleccionadas,opcionesNotaRefCruce"  rendered="#{! empty notaRefCrucePage.partidasSeleccionadas}"/>
		</h:panelGrid>
	</h:panelGrid>
</ui:composition>

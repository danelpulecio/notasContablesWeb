<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
>
    <!-- Formulario de flujo-->


    <!-- Formulario Modal de visualizacion de temas por concepto-->
    <p:dialog id="modalVer" widgetVar="modalVer" domElementAttachment="form" autosized="true" showEffect="fade"
              hideEffect="explode" modal="true">
        <f:facet name="header">
            <h:panelGroup>
                <h:outputText value="Tema: #{flujoNotaContablePage.temaActual.tema.nombre}"/>
            </h:panelGroup>
        </f:facet>
        <f:facet name="controls">
            <h:panelGroup>
                <h:graphicImage value="../../../common/images/close.png" alt="cerrar" styleClass="hidelink"
                                id="hidelinkCerrarEditorVer" height="20" width="20"/>
            </h:panelGroup>
        </f:facet>

        <!-- Campos del formulario -->

        <h:panelGrid columns="1" width="820px;" id="informacionFlujoNotaContableVer" cellpadding="0" cellspacing="0">
            <h:panelGrid columns="1" width="100%" cellpadding="0" cellspacing="0">
                <h:panelGrid columns="1" width="100%" cellpadding="0" cellspacing="5" style="height: 100%;">
                    <p:panel header="Información básica" style="width: 100%;">
                        <h:panelGrid columns="2">
                            <h:outputText value="Sucursal de Origen" styleClass="propertie"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.nota.codigoSucursalOrigen} - #{flujoNotaContablePage.nota.sucursalOrigen.nombre}"/>

                            <h:outputText value="Concepto" styleClass="propertie"/>
                            <h:outputText value="#{flujoNotaContablePage.nota.concepto.nombre}"/>

                            <h:outputText value="Tipo de Evento" styleClass="propertie"/>
                            <h:outputText value="#{flujoNotaContablePage.nota.tipoEvento.nombre}"/>

                            <h:outputText value="Fecha Contable" styleClass="propertie"/>
                            <h:panelGrid columns="3" cellpadding="0" cellspacing="0">
                                <h:outputText value="#{flujoNotaContablePage.temaActual.fechaContable}"/>
                                <p:spacer width="200"/>
                                <p:commandButton value="Riesgo Operacional"
                                                 oncomplete="PF('modalRiesgoVer').show()"
                                                 update="globalForm:modalRiesgoVer"
                                                 ajaxSingle="true"
                                                 rendered="#{flujoNotaContablePage.temaActual.tema.riesgoOperacional eq 'S'}"
                                                 immediate="true"/>
                            </h:panelGrid>

                            <h:outputText value="Descripción" styleClass="propertie"/>
                            <h:outputText value="#{flujoNotaContablePage.temaActual.descripcion}"/>

                            <h:outputText value="Divisa" styleClass="propertie"/>
                            <h:panelGrid columns="4" cellspacing="0">
                                <h:outputText value="#{flujoNotaContablePage.temaActual.codigoDivisa}"/>
                                <p:spacer width="50"/>
                                <h:outputText value="Importe" styleClass="propertie"/>
                                <h:outputText value="#{flujoNotaContablePage.temaActual.monto}">
                                    <f:convertNumber type="currency"/>
                                </h:outputText>
                            </h:panelGrid>
                        </h:panelGrid>
                    </p:panel>
                </h:panelGrid>
                <h:panelGrid columns="2" width="100%" cellpadding="0" cellspacing="5" styleClass="aligntop"
                             style="height: 100%; vertical-align: super;">
                    <p:panel header="Partida" style="width: 400px;height: 100%; ">

                        <h:panelGrid columns="1" width="100%" cellpadding="0" cellspacing="0"
                                     style=" vertical-align: top;">
                            <h:panelGrid columns="5">
                                <h:outputText value="Cuenta" styleClass="propertie"/>
                                <h:outputText value="#{flujoNotaContablePage.temaActual.tema.partidaContable}"/>
                                <p:spacer width="50"/>
                                <h:outputText value="Naturaleza" styleClass="propertie"/>
                                <h:outputText
                                        value="#{flujoNotaContablePage.temaActual.tema.naturaleza1 eq 'D'?'Debe':'Haber'}"/>
                            </h:panelGrid>
                            <h:panelGrid columns="2" id="sucursalPartidaVer">
                                <h:outputText value="Sucursal Destino" styleClass="propertie"/>
                                <h:outputText
                                        value="#{flujoNotaContablePage.temaActual.codigoSucursalDestinoPartida} #{flujoNotaContablePage.temaActual.sucursalDestinoPartida.nombre}"/>

                                <h:outputText value="Referencia" styleClass="propertie"
                                              rendered="#{flujoNotaContablePage.temaActual.tema.referencia1 eq 'S'}"/>
                                <h:outputText value="#{flujoNotaContablePage.temaActual.referencia1}"
                                              rendered="#{flujoNotaContablePage.temaActual.tema.referencia1 eq 'S'}"/>
                            </h:panelGrid>
                            <p:panel header="Tercero"
                                     rendered="#{flujoNotaContablePage.temaActual.tema.tercero1 eq 'S'}"
                                     style="width:100%; vertical-align: top;">
                                <h:panelGrid columns="2" id="documentoTercero1Ver">
                                    <h:outputText value="Tipo de documento" styleClass="propertie"/>
                                    <h:outputText value="#{flujoNotaContablePage.temaActual.nombreTipoDoc1}"/>

                                    <h:outputText value="Número Documento" styleClass="propertie"/>
                                    <h:outputText
                                            value="#{flujoNotaContablePage.temaActual.numeroIdentificacion1}"/>

                                    <h:outputText value="Dígito de Verificación" styleClass="propertie"
                                                  rendered="#{! empty flujoNotaContablePage.temaActual.nombreCompleto1}"/>
                                    <h:outputText value="#{flujoNotaContablePage.temaActual.digitoVerificacion1} "
                                                  rendered="#{! empty flujoNotaContablePage.temaActual.nombreCompleto1}"/>

                                    <h:outputText value="Nombre" styleClass="propertie"
                                                  rendered="#{! empty flujoNotaContablePage.temaActual.nombreCompleto1}"/>
                                    <h:outputText value="#{flujoNotaContablePage.temaActual.nombreCompleto1}"
                                                  rendered="#{! empty flujoNotaContablePage.temaActual.nombreCompleto1}"/>

                                    <h:outputText value="Contrato" styleClass="propertie"
                                                  rendered="#{flujoNotaContablePage.temaActual.tema.contrato1 eq 'S' and ! empty flujoNotaContablePage.temaActual.nombreCompleto1}"/>
                                    <h:outputText value="#{flujoNotaContablePage.temaActual.contrato1}"
                                                  rendered="#{! empty flujoNotaContablePage.temaActual.nombreCompleto1}"/>
                                </h:panelGrid>

                            </p:panel>
                        </h:panelGrid>
                    </p:panel>
                    <p:panel header="Contra Partida" style="width: 400px; vertical-align: top; ">

                        <h:panelGrid columns="1" width="100%" cellpadding="0" cellspacing="0"
                                     style="vertical-align: top;">
                            <h:panelGrid columns="5">
                                <h:outputText value="Cuenta" styleClass="propertie"/>
                                <h:outputText
                                        value="#{flujoNotaContablePage.temaActual.tema.contraPartidaContable}"/>
                                <p:spacer width="50"/>
                                <h:outputText value="Naturaleza" styleClass="propertie"/>
                                <h:outputText
                                        value="#{flujoNotaContablePage.temaActual.tema.naturaleza2 eq 'D'?'Debe':'Haber'}"/>
                            </h:panelGrid>
                            <h:panelGrid columns="2" width="100%" id="sucursalContraPartidaVer">
                                <h:outputText value="Sucursal Destino" styleClass="propertie"/>
                                <h:outputText
                                        value="#{flujoNotaContablePage.temaActual.codigoSucursalDestinoContraPartida} #{flujoNotaContablePage.temaActual.sucursalDestinoContraPartida.nombre}"/>

                                <h:outputText value="Referencia" styleClass="propertie"
                                              rendered="#{flujoNotaContablePage.temaActual.tema.referencia2 eq 'S'}"/>
                                <h:outputText value="#{flujoNotaContablePage.temaActual.referencia2}"
                                              rendered="#{flujoNotaContablePage.temaActual.tema.referencia2 eq 'S'}"/>
                            </h:panelGrid>
                            <p:panel header="Tercero"
                                     rendered="#{flujoNotaContablePage.temaActual.tema.tercero2 eq 'S'}"
                                     style="width:100%; vertical-align: top;">
                                <h:panelGrid columns="2" id="documentoTercero2Ver">
                                    <h:outputText value="Tipo de documento" styleClass="propertie"/>
                                    <h:outputText value="#{flujoNotaContablePage.temaActual.nombreTipoDoc2}"/>

                                    <h:outputText value="Número Documento" styleClass="propertie"/>
                                    <h:outputText
                                            value="#{flujoNotaContablePage.temaActual.numeroIdentificacion2}"/>
                                </h:panelGrid>

                                <h:panelGrid columns="1" id="tercero2Ver">
                                    <h:panelGrid columns="2"
                                                 rendered="#{! empty flujoNotaContablePage.temaActual.nombreCompleto2}">
                                        <h:outputText value="Dígito de Verificación" styleClass="propertie"/>
                                        <h:outputText
                                                value="#{flujoNotaContablePage.temaActual.digitoVerificacion2}"/>

                                        <h:outputText value="Nombre" styleClass="propertie"/>
                                        <h:outputText value="#{flujoNotaContablePage.temaActual.nombreCompleto2}"/>

                                        <h:outputText value="Contrato" styleClass="propertie"
                                                      rendered="#{flujoNotaContablePage.temaActual.tema.contrato2 eq 'S'}"/>
                                        <h:outputText value="#{flujoNotaContablePage.temaActual.contrato2}"/>
                                    </h:panelGrid>
                                </h:panelGrid>

                            </p:panel>
                        </h:panelGrid>
                    </p:panel>
                </h:panelGrid>

                <h:panelGrid columns="1" cellpadding="0" cellspacing="5" id="impuestosVer"
                             style="text-align: center;"
                             width="100%">
                    <p:dataTable id="impuestoTema" value="#{flujoNotaContablePage.temaActual.impuestoTema}" var="imp"
                                 rowIndexVar="rowIndex"
                                 widgetVar="economicActivityTable" rows="15" paginator="true"
                                 rendered="#{! empty flujoNotaContablePage.temaActual.impuestoTema}"
                                 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registros"
                                 paginatorPosition="top">

                        <h1 align="center">Liquidación de Impuestos</h1>

                        <!--<f:facet name="header">
                            <h:outputText value="Liquidación de Impuestos"/>
                        </f:facet>-->

                        <p:column headerText="" width="150" style="text-align: left;"
                                  rendered="#{flujoNotaContablePage.mostrarAsientoImpuesto }">
                            <f:facet name="header">
                                <h:panelGroup>
                                    <h:outputText value="Asiento"/>
                                    <br/>
                                    <h:outputText value="Contable"/>
                                    <br/>
                                    <h:outputText value="Altamira"/>
                                </h:panelGroup>
                            </f:facet>
                            <h:outputText value="#{imp.numeroAsiento}"/>
                        </p:column>

                        <p:column headerText="Nombre" width="150" style="text-align: left;">
                            <h:outputText value="#{imp.impuestoTema.impuesto.nombre}"/>
                        </p:column>

                        <p:column headerText="Porcentaje" width="80" style="text-align: right;">
                            <h:outputText value="#{imp.impuestoTema.impuesto.valor}%"/>
                        </p:column>

                        <p:column headerText="Base" width="140" style="text-align: right;">
                            <h:outputText rendered="#{not imp.boolExonera}" value="#{imp.base}"
                                          converter="javax.faces.Double">
                                <f:convertNumber type="currency" maxFractionDigits="2"/>
                            </h:outputText>
                            <h:outputText rendered="#{imp.boolExonera}" value="NA"/>
                        </p:column>

                        <p:column headerText="Calculado" width="140" style="text-align: right;">
                            <h:outputText rendered="#{not imp.boolExonera}" value="#{imp.calculado}"
                                          converter="javax.faces.Double">
                                <f:convertNumber type="currency" maxFractionDigits="2"/>
                            </h:outputText>
                            <h:outputText rendered="#{imp.boolExonera}" value="NA"/>
                        </p:column>

                        <p:column headerText="Exonerar" width="80" style="text-align: center;">
                            <h:outputText value="#{imp.boolExonera?'Si':'No'}"/>
                        </p:column>
                    </p:dataTable>
                </h:panelGrid>

                <h:panelGrid columns="1" cellpadding="0" cellspacing="2" id="anexosVer" style="text-align: center;"
                             width="100%">
                    <p:dataTable id="tableAnexosVer" value="#{flujoNotaContablePage.temaActual.anexoTema}" var="anexo"
                                 rowIndexVar="rowIndex"
                                 widgetVar="economicActivityTable" rows="15" paginator="true"
                                 paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                 currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registros"
                                 paginatorPosition="top">

                        <h1 align="center">Soportes del Tema</h1>

                        <!--<f:facet name="header">
                            <h:outputText value="Soportes del tema"/>
                        </f:facet>-->

                        <p:column headerText="Fecha" width="150" style="text-align: left;">
                            <h:outputText value="#{anexo.fechaHora}"/>
                        </p:column>

                        <p:column headerText="Usuario" style="text-align: right;">
                            <h:outputText value="#{anexo.usuNombre}"/>
                        </p:column>

                        <p:column headerText="Archivo" style="text-align: right;">

                            <p:commandLink action="#{downloadGeneralPage.download}" styleClass="bold"
                                           value="#{anexo.nombre}" target="_blank" ajax="false">
                                <f:setPropertyActionListener for="type2" value="#{downloadGeneralPage.SOPORTE}"
                                                             target="#{downloadGeneralPage.type}"/>
                                <f:setPropertyActionListener for="file2" value="#{anexo.archivo}"
                                                             target="#{downloadGeneralPage.file}"/>
                            </p:commandLink>

                        </p:column>
                    </p:dataTable>
                </h:panelGrid>
            </h:panelGrid>
            <h:panelGrid columns="2" styleClass="center" width="100%">

                <!-- seccion de <form></form>peracional -->
                <p:dialog id="modalRiesgoVer" widgetVar="modalRiesgoVer"
                          domElementAttachment="form"
                          autosized="true"
                          showEffect="fade"
                          hideEffect="explode" modal="false">
                    <f:facet name="header">
                        <h:panelGroup>
                            <h:outputText
                                    value="Riesgo operacional para el tema: #{flujoNotaContablePage.temaActual.tema.nombre}"/>
                        </h:panelGroup>
                    </f:facet>
                    <f:facet name="controls">
                        <h:panelGroup>
                            <h:graphicImage value="../../../common/images/close.png" alt="cerrar"
                                            styleClass="hidelink"
                                            id="hidelinkCerrarModalRiesgoVer" height="20" width="20"/>
                        </h:panelGroup>
                    </f:facet>
                    <h:panelGrid width="550">
                        <h:panelGrid columns="2" width="100%">
                            <h:outputText value="Importe Total" styleClass="propertie" reRender="selectsRiesgo"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.importeTotal}">
                                <f:convertNumber type="currency"/>
                            </h:outputText>

                            <h:outputText value="Importe Parcial" styleClass="propertie" reRender="selectsRiesgo"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.importeParcial}">
                                <f:convertNumber type="currency"/>
                            </h:outputText>

                            <h:outputText value="Fecha Inicio del Evento" styleClass="propertie"
                                          reRender="selectsRiesgo"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.fechaEvento}"/>

                            <h:outputText value="Hora Inicio Evento" styleClass="propertie"
                                          reRender="selectsRiesgo"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.horaTotalInicio}"/>

                            <h:outputText value="Fecha Fin Evento" styleClass="propertie" reRender="selectsRiesgo"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.fechaFinEvento}"/>

                            <h:outputText value="Hora Fin Evento" styleClass="propertie" reRender="selectsRiesgo"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.horaTotalFin}"/>

                            <h:outputText value="Fecha del Descubrimiento" styleClass="propertie"
                                          reRender="selectsRiesgo"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.fechaDescubrimientoEvento}"/>

                            <h:outputText value="Hora del Descubrimiento" styleClass="propertie"
                                          reRender="selectsRiesgo"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.horaTotalDescubre}"/>

                            <h:outputText value="Clase de Riesgo" styleClass="propertie" reRender="selectsRiesgo"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.claseRiesgo.nombre}"/>

                            <h:outputText value="Perdida Operacional" styleClass="propertie"
                                          reRender="selectsRiesgo"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.tipoPerdida.descripcion}"/>

                            <h:outputText value="Proceso" styleClass="propertie" reRender="selectsRiesgo"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.proceso.nombre}"/>

                            <h:outputText value="Línea Operativa" styleClass="propertie" reRender="selectsRiesgo"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.lineaOperativa.nombre}"/>

                            <h:outputText value="Producto Afectado" styleClass="propertie"
                                          reRender="selectsRiesgo"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.producto.nombre}"/>

                            <h:outputText styleClass="propertie" value="SubProducto Afectado"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.subProductoAfectado.nombre}"/>

                            <h:outputText styleClass="propertie" value="Canal"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.canal.descripcion}"/>

                            <h:outputText styleClass="propertie" value="subCanal"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.subCanal.descripcion}"/>

                            <h:outputText styleClass="propertie" value="Sfc Clase Riesgo N2"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.claseRiesgoN2.nombre}"/>

                            <h:outputText styleClass="propertie" value="Sfc Clase Riesgo N3"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.claseRiesgoN3.nombre}"/>

                            <h:outputText styleClass="propertie" value="Nombre Outsourcing"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.nombreOutSource}"/>

                            <h:outputText styleClass="propertie" value="Aplica Recuperación"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.appRecuperacion}"/>

                            <h:outputText styleClass="propertie" value="Fecha Recuperación"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.fechaRecuperacion}"/>

                            <h:outputText styleClass="propertie" value="Hora Recuperación"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.horaTotalRecuperacion}"/>

                            <h:outputText styleClass="propertie" value="Tipo Recuperación"/>
                            <h:outputText
                                    value="#{flujoNotaContablePage.temaActual.riesgoOperacional.tipoRecuperacion}"/>
                        </h:panelGrid>

                    </h:panelGrid>
                </p:dialog>
            </h:panelGrid>
        </h:panelGrid>

    </p:dialog>

    <p:dialog id="popupFlujoNotaContableVer"
              widgetVar="popupFlujoNotaContableVer"
              domElementAttachment="form"
              autosized="true"
              showEffect="fade"
              hideEffect="explode"
              modal="true">
        <f:facet name="header">
            <h:panelGroup>
                <h:outputText value="Nota Cotable"/>
            </h:panelGroup>
        </f:facet>
        <f:facet name="controls">
            <h:panelGroup>
                <h:graphicImage value="../../../common/images/close.png" alt="cerrar" styleClass="hidelink"
                                id="hidelinkCerrarFlujoVer" height="20" width="20"/>
            </h:panelGroup>
        </f:facet>
        <!--Formulario principal	-->

        <h:panelGrid columns="1" width="970px;" cellpadding="0" cellspacing="5">
            <p:panel header="Información básica" style="width: 100%;">
                <h:panelGrid columns="2">
                    <h:outputText value="Sucursal de Origen" styleClass="propertie"/>
                    <h:outputText
                            value="#{flujoNotaContablePage.nota.codigoSucursalOrigen} - #{flujoNotaContablePage.nota.sucursalOrigen.nombre}"/>

                    <h:outputText value="Concepto" styleClass="propertie"/>
                    <h:outputText value="#{flujoNotaContablePage.nota.concepto.nombre}"/>

                    <h:outputText value="Tipo de Evento" styleClass="propertie"/>
                    <h:outputText value="#{flujoNotaContablePage.nota.tipoEvento.nombre}"/>
                </h:panelGrid>
            </p:panel>
            <p:panel header="Temas del Concepto" style="width: 100%;"
                     rendered="#{flujoNotaContablePage.nota.codigoConcepto gt 0}">
                <p:dataTable id="tableTemasVer" value="#{flujoNotaContablePage.temasNotaContable}" var="temaNota"
                             rowIndexVar="rowIndex"
                             widgetVar="economicActivityTable" rows="15" paginator="true"
                             paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registros"
                             paginatorPosition="top">

                    <p:column headerText="Asiento" rendered="#{flujoNotaContablePage.mostrarAsiento}">
                        <h:outputText value="#{temaNota.numeroAsiento} "/>
                    </p:column>

                    <p:column headerText="Nombre del Tema">
                        <h:outputText value="#{temaNota.tema.nombre} "/>
                    </p:column>

                    <p:column headerText="Soportes" style="text-align: center;">
                        <h:outputText value="#{flujoNotaContablePage.nota.concepto.soportes eq 'S'?'Si':'No'}"/>
                    </p:column>

                    <p:column headerText="Riesgo" style="text-align: center;">
                        <h:outputText value="#{temaNota.tema.riesgoOperacional eq 'S'?'Si':'No'}"/>
                    </p:column>

                    <p:column headerText="Divisa">
                        <h:outputText value="#{temaNota.codigoDivisa}"/>
                    </p:column>

                    <p:column headerText="Importe" style="text-align: right;">
                        <h:outputText value="#{temaNota.monto}">
                            <f:convertNumber type="currency"/>
                        </h:outputText>
                    </p:column>

                    <p:column headerText="Ver" style="text-align: center;">
                        <p:commandButton action="#{flujoNotaContablePage.verNota}"
                                         oncomplete="PF('modalVer').show();"
                                         update="globalForm:modalVer"
                                         icon="pi pi-search"
                                         styleClass="rounded-button ui-button-success"
                                         alt="Ver"
                                         rendered="#{temaNota.codigo gt 0 }">
                            <f:setPropertyActionListener for="codigoTema" value="#{temaNota.codigo}"
                                                         target="#{flujoNotaContablePage.codigo}"/>
                        </p:commandButton>
                    </p:column>
                    <f:facet name="footer">
			            <span class="font-bold">
			            	<p:dataTable style="border-width: 0px; background-color: transparent;"
                                         value="#{flujoNotaContablePage.totalesNota}" var="total">
                                    <p:column colspan="#{flujoNotaContablePage.mostrarAsiento?4:3}"
                                              style="text-align:right; border-width: 0px;">
		                                <h:outputText value="Totales"/>
		                            </p:column>      
                                    <p:column style="border-width: 0px; text-align:left;">
                                        <h:outputText value="#{total.codigoDivisa }"/>
                                    </p:column>
                                    <p:column style="border-width: 0px; text-align:right;">
                                        <h:outputText value="#{total.total}">
                                            <f:convertNumber type="currency"/>
                                        </h:outputText>
                                    </p:column>
                                    <p:column style="border-width: 0px; text-align:lefth;"></p:column>
                             </p:dataTable>
			            </span>
                    </f:facet>
                </p:dataTable>
            </p:panel>

            <p:dialog id="popupRechazoVer" widgetVar="popupRechazoVer" autosized="true" domElementAttachment="form"
                      width="750px"
                      showEffect="fade" hideEffect="explode" modal="false">
                <f:facet name="header">
                    <h:panelGroup>
                        <h:outputText value="Rechazar nota contable"/>
                    </h:panelGroup>
                </f:facet>

                <h:panelGrid columns="1" width="100%">

                    <h:outputText
                            value="Si esta seguro que desea rechazar la nota actual, por favor indique la causal de devolucion."/>

                    <p:separator width="100%"/>
                    <h:outputText value="Causal de devolución"/>
                    <p:selectOneMenu value="#{flujoNotaContablePage.causalDevolucion}">
                        <f:selectItem itemValue="-1" itemLabel="Seleccione una opcion"/>
                        <f:selectItems value="#{flujoNotaContablePage.causalesDev}"/>
                        <p:ajax event="change" update="globalForm:otraCausalVer"/>
                    </p:selectOneMenu>
                    <h:panelGrid columns="1" width="100%" id="otraCausalVer">
                        <h:outputText value="Descripción de la causal"
                                      rendered="#{flujoNotaContablePage.causalDevolucion eq 18}"/>
                        <p:inputText value="#{flujoNotaContablePage.otraCausalDev}"
                                     rendered="#{flujoNotaContablePage.causalDevolucion eq 18}" size="80"/>
                    </h:panelGrid>
                    <!-- Seccion de mensajes y botones de envio y cancelacion-->
                    <ui:include src="../../common/mensajes.xhtml"/>
                    <h:panelGrid columns="2" styleClass="center" width="100%">
                        <p:commandButton action="#{flujoNotaContablePage.rechazar}" value="Confirmar rechazo" ajax="false"
                                         update="lista,opcionesVer"/>
                        <p:commandButton onclick="PF('popupRechazoVer').hide()" value="Cancelar"/>
                    </h:panelGrid>
                </h:panelGrid>
            </p:dialog>

            <ui:include src="../../common/mensajes.xhtml"/>

            <h:panelGrid id="opcionesVer" columns="2" styleClass="center" width="100%">
                <p:commandButton action="#{flujoNotaContablePage.aprobar}"
                                 update="lista,opcionesVer" ajax="false" value="Aprobar"
                                 rendered="#{flujoNotaContablePage.nota.puedeAprobar}"/>
                <p:commandButton value="Rechazar" rendered="#{flujoNotaContablePage.nota.puedeRechazar}"
                                 oncomplete="PF('popupRechazoVer').show()"/>
            </h:panelGrid>
        </h:panelGrid>

    </p:dialog>

</ui:composition>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                template="../../common/template.xhtml">
    <ui:param name="title" value="Notas Contables en Precierre"/>
    <ui:define name="body">

        <ui:include src="../common/flujoSubPage.xhtml"/>
        <ui:include src="../notacontable/flujoNotaContablePage.xhtml"/>
        <ui:include src="../notacontable/flujoNotaContableLibrePage.xhtml"/>
        <ui:include src="../notacontable/flujoNotaRefCrucePage.xhtml"/>

        <!--Filtro de busqueda	-->
        <div style="width: 1200px;">
            <p:panel style="width: 1320px">
                <h:panelGrid columns="1" width="100%">
                    <h1 align="center">Notas Contables en Precierre</h1>
                </h:panelGrid>

                <h:panelGroup id="msgPreCierre">
                    <ui:include src="../../common/mensajes.xhtml"/>
                </h:panelGroup>

                <!-- Tabla de registros -->
                <h:panelGrid columns="1" width="1300px" style="align:center;" id="lista">
                    <p:poll listener="#{precierrePage.mostrar}"
                            rendered="#{empty precierreCierrePage.datos and facesContext.maximumSeverity == null}"
                            update="lista, globalForm:msgPreCierre"
                            autoStart="true" interval="1"/>
                    <h:panelGrid columns="2" width="100%" style="text-align:center;">
                        <p:commandButton value="Generar Archivo Altamira"
                                         action="#{precierrePage.generarArchivoAltamira}"
                                         update="lista"
                                         rendered="#{!empty precierreCierrePage.datos}"/>
                        <p:commandButton value="Generar Archivo Excel"
                                         action="#{precierrePage.generarArchivoExcel}"
                                         update="lista"
                                         ajax="false"
                                         rendered="#{!empty precierreCierrePage.datos}"/>
                    </h:panelGrid>
                    <h:panelGrid columns="4" width="100%" style="align:center;">

                    <p:commandLink action="#{downloadGeneralPage.download}" styleClass="bold"
                                   value="#{precierreCierrePage.excelFileName}" target="_blank"
                                   rendered="#{precierreCierrePage.mostrarArchExc}" ajax="false">
                        <f:setPropertyActionListener for="type1" value="#{downloadGeneralPage.REPORTE_EXCEL}"
                                                     target="#{downloadGeneralPage.type}"/>
                        <f:setPropertyActionListener for="file1" value="#{precierreCierrePage.excelFileName}"
                                                     target="#{downloadGeneralPage.file}"/>
                    </p:commandLink>

                    <p:commandLink action="#{downloadGeneralPage.download}" styleClass="bold"
                                   value="#{precierrePage.INTERFAZ_CONTABLE_FILE_NAME}" target="_blank"
                                   rendered="#{precierreCierrePage.mostrarArchAlt}" ajax="false">
                        <f:setPropertyActionListener for="type2" value="#{downloadGeneralPage.TRANSMISION_ALTAMIRA}"
                                                     target="#{downloadGeneralPage.type}"/>
                        <f:setPropertyActionListener for="file2"
                                                     value="#{precierrePage.INTERFAZ_CONTABLE_FILE_NAME}"
                                                     target="#{downloadGeneralPage.file}"/>
                    </p:commandLink>

                    <p:commandLink action="#{downloadGeneralPage.download}" styleClass="bold"
                                   value="#{precierrePage.PUC_FILE_NAME}" target="_blank"
                                   rendered="#{precierreCierrePage.mostrarArchAlt}" ajax="false">
                        <f:setPropertyActionListener for="type3" value="#{downloadGeneralPage.TRANSMISION_ALTAMIRA}"
                                                     target="#{downloadGeneralPage.type}"/>
                        <f:setPropertyActionListener for="file3" value="#{precierrePage.PUC_FILE_NAME}"
                                                     target="#{downloadGeneralPage.file}"/>
                    </p:commandLink>

                    <p:commandLink action="#{downloadGeneralPage.download}" styleClass="bold"
                                   value="#{precierrePage.TERCEROS_FILE_NAME}" target="_blank"
                                   rendered="#{precierreCierrePage.mostrarArchAlt}" ajax="false">
                        <f:setPropertyActionListener for="type4" value="#{downloadGeneralPage.TRANSMISION_ALTAMIRA}"
                                                     target="#{downloadGeneralPage.type}"/>
                        <f:setPropertyActionListener for="file4" value="#{precierrePage.TERCEROS_FILE_NAME}"
                                                     target="#{downloadGeneralPage.file}"/>
                    </p:commandLink>

                    <!-- arhivo NC_INDICAPC_NTCON.TXT -->
                    <p:commandLink action="#{downloadGeneralPage.download}" styleClass="bold"
                                   value="#{precierrePage.NC_INDICAPC}" target="_blank"
                                   rendered="#{precierreCierrePage.mostrarArchAlt}" ajax="false">
                        <f:setPropertyActionListener for="type4" value="#{downloadGeneralPage.TRANSMISION_ALTAMIRA}"
                                                     target="#{downloadGeneralPage.type}"/>
                        <f:setPropertyActionListener for="file4" value="#{precierrePage.NC_INDICAPC}"
                                                     target="#{downloadGeneralPage.file}"/>
                    </p:commandLink>

                    </h:panelGrid>
                    <ui:include src="precierreCierreFormPage.xhtml"/>
                </h:panelGrid>
            </p:panel>
        </div>
    </ui:define>
</ui:composition>
